{"name":"Plastronjs","body":"![Logo](data:image/gif;base64,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)\r\n# PlastronJS #\r\nformerly goog.mvc\r\n\r\nPlastronJS is an MVC library which uses the Google Closure library for use with the Closure Compiler. I've decided to call it Plastron after the name of the underside of the turtle to mimic names of frameworks like Backbone and Spine but also because it's a good base to build upon.\r\n\r\nPlastronJS though is not just a MVC framework, it's the start of an application framework. I've decided to include a mediator and a store with the package which will hopefully help in the construction of medium to large size applications.\r\n\r\nThe source code should be well documented and I plan on including tutorials on my blog at http://rhysbrettbowen.com. Feel free to contact me at rhysbrettbowen@gmail.com if there are any questions\r\n\r\nThe folder should be put in your project directory and the path passed to the closure compiler. I have my project folder setup like this:\r\n\r\n    myApp/\r\n        js/ <- your main app code here.\r\n        lib/ <- libraries you use here.\r\n            mvc/ <- PlastronJS here.\r\n        styles/ <- CSS/GSS/SASS etc.\r\n        template/ <- Soy files here.\r\n\r\nto use a module you'll need to include it\r\n\r\n```javascript\r\ngoog.require('mvc.Model');\r\n```\r\n\r\nI decided to leave the namespace that the project is under at mvc for two reasons. The first is that it's simpler to write than PlastronJS and the second is that it makes more sense in the code.\r\n\r\nI'd like to point out that I've spent a lot of time reading the source code of other MVC frameworks, most notably Backbone.js so hopefully it will seem fairly familiar. There are however some notable differences. The closure compiler does not mix dot notation and square bracket notation so a lot of the nice linking to functions based on names was out of the question. I also want this framework to work for larger applications. A lot of people find trouble with the current mvc frameworks because they don't scale well or provide functionality for more complex systems. I'm hoping that I have addressed this. Lastly I developed this MVC to use on the webclient at Catch.com so some of the decisions I made were based on what I needed - but I have also included extra functionality I am not using and this means that some parts are not tested as rigorously. If you do spot any bugs or any features that need fine tuning please let me know or fork the project and make some changes.\r\n\r\nIf you are new to closure then you need this book http://www.amazon.com/Closure-Definitive-Guide-Michael-Bolin/dp/1449381871\r\n\r\n## mvc.Model ##\r\n\r\nThe model is the main component. It allows you to store data and send out change events when it changes (it extends goog.events.EventTarget). It also communicates with the data store through mvc.Sync\r\n\r\n### make a Model ###\r\n\r\nYou can instantiate a new model directly, or you may wish to create a new type of model that inherits from mvc.Model like so:\r\n\r\n```javascript\r\ngoog.require('mvc.Model');\r\n\r\n/**\r\n * @constructor\r\n * @inheritDoc\r\n */\r\nvar Person = function(firstName, lastName) {\r\n    goog.base(this, {attr: {\r\n        'firstName': firstName,\r\n        'lastName': lastName\r\n    }});\r\n    this.meta('name', ['firstName','lastName'], function(firstName, lastName) {\r\n        return lastName + \", \" + firstName;\r\n    });\r\n};\r\ngoog.inherits(Person, mvc.Model);\r\n```\r\n\r\nAnother option is to just create a model and differentiate it by a schema:\r\n\r\n```javascript\r\nvar Rhys = mvc.Model.create({\r\n    'schema': myApp.schema.Person\r\n    });\r\n```\r\n\r\nwe'll go in to schemas later.\r\n\r\nAny setup would go in the constructor function (in the above we used the meta function to create a meta attribute). You can override methods and add new methods of your own.\r\n\r\n### new Model options ###\r\n\r\nWhen creating a new model instance, the constructor takes an options object. The options object takes the special keys 'schema', 'sync' and 'attr'. You can put any attributes directly in the object except for the reserved keywords of schema, sync and attr. If you do wish to use these in your model then you can place them under the attr keyword. To be safe it's best to put them all under the attr keyword. So an options object might look a little something like this:\r\n\r\n```javascript\r\nvar attr = {\r\n  'firstName': 'Rhys',\r\n  'lastName': 'Brett-Bowen'\r\n};\r\nvar options = {\r\n  'attr': attr,\r\n  'sync': new mvc.AjaxSync()\r\n};\r\n```\r\n\r\nor\r\n\r\n```\r\nvar options = {\r\n  'firstName': 'Rhys',\r\n  'lastName': 'Brett-Bowen'\r\n};\r\n```\r\n\r\nin the second example I put the attributes right in the object. I can do this and mix them with 'schema' and 'sync'. Just remember that 'attr', 'sync' and 'schema' are reserved words, 'attr' is a safe place for attributes and 'sync' and 'schema' are reserved.\r\n\r\nYou might also noticed that I put quotes around the keys in the object. This is necessary as closure would rename the keys after compilation and that means that shema could become 'c' which would be put in as an attribute. I will point out where you need to use quotes and where they are optional as I go on.\r\n\r\n### get and set key/values ###\r\n\r\nYou should always use the get() and set() functions when dealing with the model's data. These functions take care of saving old data and publishing change events. To get and set data you can do the below:\r\n\r\n```javascript\r\nmodel.get('firstName'); // returns 'Rhys'\r\nmodel.set('firstName', 'Bruce');\r\nmodel.get('firstName'); //returns 'Bruce'\r\n```\r\n\r\n### customizing get and set ###\r\n\r\nYou can also manipulate how you get and set the data using these functions by either specifying a schema object (which we'll go in to later) or by using the below functions to modify the model's default schema\r\n\r\nThe alias function allows you to get a member using a different name\r\n\r\n```javascript\r\nmodel.set('lastName', 'Brett-Bowen');\r\nmodel.alias('surname', 'lastName');\r\nmodel.get('surname'); // returns 'Brett-Bowen'\r\n```\r\n\r\nThe format function allows you to change how the data is presented\r\n\r\n```javascript\r\nmodel.set('now', new Date());\r\nmodel.format('now', function(now) {return now.toDateString()});\r\nmodel.get('now'); // returns the set date as a string\r\n```\r\n\r\nThe meta function is passed the new variable name, an array or attributes to base the data off and the formatting function. To do this you need to pass the new attribute name, the required attributes and the function.\r\n\r\n```javascript\r\nmodel.set({\r\n    'firstName': 'Rhys',\r\n    'lastName': 'Brett-Bowen'\r\n    });\r\nmodel.meta('name', ['firstName', 'lastName'], function(firstName, lastName) {\r\n    return lastName + \", \" + Rhys;\r\n});\r\nmodel.get('name'); // returns \"Brett-Bowen, Rhys\"\r\n```\r\n\r\n### setting and validation ###\r\n\r\nYou can also change how you set and validate data by using the setter function. you can do any checks on the data in the function and throw and error if it doesn't pass. The errors are handled by the model's error handling function. By default it just ignores the error and the value isn't set, but you can override it by:\r\n\r\n```javascript\r\n  var errorFn = function(err) {\r\n    alert(err.getMessage());\r\n  };\r\n  model.errorHandler(errorFn);\r\n```\r\n\r\nWe can then put in a formatting and validating function for our name\r\n\r\n```javascript\r\nmodel.setter('firstName', function(name) {\r\n  name = goog.string.trim(name);\r\n  if (!name.length)\r\n    throw new Error(\"name can not be blank\");\r\n  return name;\r\n})\r\n```\r\n\r\nthe above will check to see that a name isn't blank and trim the input.\r\n\r\n### Binding & unbinding data ###\r\n\r\nthe real power in a model comes in binding. You can bind keys, or computed keys to functions. The bind function takes three arguments. The first is the attribute name or an array of attribute names whose changes you want to listen to. The second is a function which will be passed the value of each of the items you are listening to and the model. The final parameter is the object to bind the function to. So you could do this:\r\n\r\n```javascript\r\nvar task = new mvc.Model({'done':false,'important':false});\r\nvar element = document.getElementById('myTask');\r\nvar bound = task.bind(['done','important'], function(done, important) {\r\n    this.checked = done;\r\n    this.setProperty('important', important);\r\n  }, element);\r\n// changes to done or important will change the element\r\ntask.unbind(bound);\r\n//changes will no longer change the element\r\n```\r\n\r\nin the example above we saved a uid in bound that we can use to unbind a listener. All bind functions return a uid that can be used with unbind.\r\n\r\n### binding keys to a function ###\r\n\r\nthe model class comes with a function getBinder that can be used to bind a function to a key. For instance you can use it for convenience methods to get and set keys:\r\n\r\n```javascript\r\nvar lat = model.getBinder('location:latitude');\r\nlat(3) // sets the location:latitude to 3\r\nlat() // returns 3\r\n```\r\n\r\nyou can even use this with the bind method above to bind a key with a key from another model\r\n\r\n```javascript\r\n// married couple living together\r\nvar husband = new mvc.Model({'city':'San Francisco'});\r\nvar wife = new mvc.Model({'city':'San Francisco'});\r\nhusband.bind('city', wife.getBinder('city'));\r\nhusband.set('city', 'New York');\r\nwife.get('city') // returns New York\r\n```\r\n\r\n### listening to all changes ###\r\n\r\nif you want to listen to any change you can use bindAll and just pass in a function. and an optional handler.\r\n\r\n### unload ###\r\n\r\nthere is also a bindUnload that takes in a function and an optional handler to be fired when the model's dispose() method is called.\r\n\r\n### other functions ###\r\n\r\nThere are also other functions that can take parameters such as the boolean \"silent\" to suppress change events. The other functions available on a model are:\r\n\r\n- toJson: used to return a json model that can be used by mvc.Sync or other objects. You should generally override this method with your own implementation\r\n- setSync(mvc.Sync): will set the sync used by the object\r\n- reset(silent): clears the attributes\r\n- isNew: returns a boolean if an id has been set (rather than just a cid)\r\n- setSchema(Obj): sets the schema\r\n- addSchemaRules(Obj): will extend the schema object with the object passed in\r\n- has(string): whether the model has the key\r\n- unset(string): deletes a key (sets to undefined)\r\n- change: manually fire a change event - handy if you've been using silent for bulk operations\r\n- prev(string): the previous value of an attribute, gets the raw data\r\n- getChanges: tells you what values has changed since the last change event used internally by bind to figure out what to fire change events for\r\n- revert: rolls back to the previous attributes\r\n- fetch(callback, silent): updates the model using it's sync\r\n- save: tells the sync to create/update\r\n- dispose(bool): disposes of the model and all it's listeners. Pass true if you want the model to call the model's sync's delete function\r\n\r\n## Schema ##\r\n\r\nYou can also set a schema for a model. A schema is an object which has a set of keys for which you want getters and setters. Under the key you can put an object with the keys of get, set and require. The get function works much like the meta function above (in fact the meta function is just a nice way to add things to the schema). The function will accept in the values for any attributes you put in the require array. The set function will take the value and should return the data to get set on the model. You can also throw errors to stop the value saving and fire the models handleErr_ function which you should set. an example of a schema:\r\n\r\n```javascript\r\n{\r\n    'firstname': {\r\n        set: function(name) {\r\n            if(name.length > 64)\r\n                throw new Error(\"name is too long\");\r\n            return goog.string.trim(name);\r\n        }\r\n    },\r\n    'fullName': {\r\n        get: function(first, last) {\r\n            return last + \", \" + first;\r\n        },\r\n        require: ['firstname','lastname']\r\n    }\r\n}\r\n```\r\n\r\nthe require should be put in for any user defined attributes as the model goes up the require chain to decide when to fire a change event on these attributes.\r\n\r\n### comparing ###\r\n\r\nA model decides whether it has changed by keeping an unsafe clone of the attributes object form the previous change event. The model will only be able to make comparisons between native types and arrays of native types. Objects such as maps or generated objects will always return as a change unless you set a comparator function in the schema. You can do this by:\r\n\r\n```javascript\r\n{\r\n  'user': {\r\n    cmp: function(a, b) {return a.id == b.id;}\r\n  }\r\n}\r\n```\r\n\r\nA comparator function is set on the schema under the cmp keyword and should take the form of a function that takes the two objects and returns true if they match or false otherwise. the mvc.Model has some comparison functions already bake in that you can use:\r\n\r\n```javascript\r\n// recurse through the object/arrays and compare all primitive values\r\nmvc.Model.Compare.RECURSIVE;\r\n// call the toString() method on the objects and compare\r\n// only use this if you've set a .toString() for the objects\r\nmvc.Model.Compare.STRING;\r\n// serialize the object as json then compare the strings\r\n// uses closures json serializer\r\nmvc.Model.Compare.SERIALIZE;\r\n```\r\n\r\n## mvc.Collection ##\r\n\r\nA mvc.Collection extends mvc.Model and so has all of it's properties. Also a collection can contain an array of models that belong to it. A collection can keep these models in an order if given a comparator function.\r\n\r\n### Sorting ###\r\n\r\nA comparator function works the same as the javascript array.sort function - taking two models and returning -1, 0 or 1 and will also listen to changes and emit a change if any model it contains fires a change event.\r\n\r\n### children ###\r\n\r\nThe mvc.Collection can also take a modelType which works with the newModel method that takes an options map and will create a new model of the type passed in. So you can create new students is a class like this:\r\n\r\n```javascript\r\nvar student = function(options){\r\n    goog.base(this, options)\r\n};\r\ngoog.inherits(student, mvc.Model);\r\nvar class = new mvc.Collection({\r\n    'modelType': student,\r\n    'name': 'clodure mvc 101'\r\n});\r\nclass.addModel({'name':'Fred'});\r\n// class now has a student called fred\r\n```\r\n\r\n### options ###\r\n\r\nthe options object for a collection is slightly different to that of a model. It has three extra reserved words. 'comparator' which is the comparison function, 'modelType' which is the base model to create when putting in a new child and 'models' which is an array of mvc.Models that should be added to the collection.\r\n\r\n### other functions ###\r\n\r\nA collection also offers these aditional methods:\r\n\r\n- pluck([keys]): returns an array of json models with the keys and values of each model\r\n- setComparator(Function): change the comparator function to keep the models in order\r\n- getLength: number of models contained\r\n- sort(silent): used internally to sort the models\r\n- add(mvc.Model, index, silent): adds a model to the end unless an index is given\r\n- remove(mvc.Model, silent): removes the model\r\n- getById(id): returns a model by it's id\r\n- getModels(Function): returns an array of the models optionally filtered by a function that takes the model and the index and returns true if it should be returned in the filter otherwise false\r\n- at(index): return the model at an index\r\n- clear: clears all the models\r\n- modelChange(function, handler): like bind for model but is bound only on changes to the collections children being sorted or added/removed\r\n\r\n## mvc.Store ##\r\n\r\nThis can be used as a factory and cache for models. Use the get to retrieve models by their ID and if they don't exist they will be created. This is good to make sure your models are unique. If no ID is passed then a new model will be created and you can get the model using it's CID until an ID is set for the model.\r\n\r\n```javascript\r\nvar store = new mvc.Store();\r\nvar a = store.get(111); // store creates a new object with id 12345\r\n                        // it then calls sync to load it\r\nvar b = store.get(111);\r\na == b; //true\r\n\r\na = store.get(); // a is a new model\r\na.set('id', 12345)\r\nb = store.get(12345);\r\na == b; // true, store listens to changes on id and sets it when one is set\r\n```\r\n\r\n## mvc.Control ##\r\n\r\nThe mvc.Control inherits from goog.ui.Component and so works in a similar way. You create it's DOM in the createDom method and can make changes to it's dom by setting up listeners in the enterDocument method.\r\n\r\n### making a new control ###\r\n\r\nadding in a control is the same as adding in a goog.ui.component. The only thing is that you have to pass it a model or collection that it is to be associated with. You'll then be able to access it through the controls getModel() method.\r\n\r\n```javascript\r\nvar model = new mvc.Model();\r\nvar control = new mvc.Control(model);\r\ncontrol.getModel() == model; // true\r\n```\r\n\r\n### getting a child element ###\r\n\r\na control has the function getEls(selector) which can find elements in it's DOM for you. All you need to do is pass it a valid selector that can be in the form of:\r\n\r\n- \".className\"\r\n- \"#elementId\"\r\n- \"tagName[ .className]\"\r\n\r\nwhere the square brackets show that it is optional.\r\n\r\n### handling events ###\r\n\r\nhandling events are done slightly different to what you may be used to. A control only has one listener per event type and manually decides which handlers to fire. To listen for an event you just need to do this:\r\n\r\n```javascript\r\ncontrol.prototype.enterDocument = function() {\r\n  goog.base(this, 'enterDocument');\r\n  this.on(goog.events.EventType.CLICK, function() {\r\n    alert('clicked');\r\n  });\r\n};\r\n```\r\n\r\nfor clicks there is even a convenience function called .click()\r\n\r\nBut what if you want to listen for a click on a particular element?\r\n\r\n### delegating events ###\r\n\r\nYou can decide whether or not to fire a handler by either the className of the element (or an array of classNames if it can fire or any of them) or a function that takes the event and returns true if it should be handled. for instance:\r\n\r\n```javascript\r\nthis.click(function(){alert('click')}, [\"star\", \"unstar\"]);\r\n```\r\n\r\nwill fire for any element that has the class star or unstar. If you want to fine tune it more you could use a function:\r\n\r\n```javascript\r\nthis.click(function(){alert(\"click\");}, function(e) {return e.clientX<100;});\r\n```\r\n\r\nthis will fire for clicks in the left 100px of the screen that are on the control.\r\n\r\n### handling priorities ###\r\n\r\nBecause of all this we need finer control over what should fire first. because of this the .on() method can also take a priority. The default priority is 50 and items with the same priority will be executed in the order they are given. You can change this by giving a lower number, which is a higher priority.\r\n\r\n```javascript\r\nvar a = this.click(function(){alert('a')});\r\nvar b = this.click(function(){alert('b')});\r\n// click will alert a the alert b\r\nthis.off(a);\r\nthis.off(b);\r\na = this.click(function(){alert('a')});\r\nb = this.click(function(){alert('b')}, undefined, this, 40);\r\n// click will alert b then alert a\r\n```\r\n\r\nabove the arguments in the last click call are the function, the decider function/classname filter (undefined for no filter so fire on all clicks), the optional handler to bind the function to (it binds to this by default, but putting in this is shorted than undefined) and then the last parameter is the priority which should be a number.\r\n\r\n### unhandling ###\r\n\r\nyou can use the off method like I have above to unbind any handlers just like unbind in models.\r\n\r\n### handling notes ###\r\n\r\nyou can create other convenience functions like click easily using the goog.bind. All you need to do is this:\r\n\r\n```javascript\r\n  this.mouseOver = goog.bind(this.on, this, goog.events.EventType.MOUSE_OVER);\r\n```\r\n\r\nyou can also handle an event only once by using the .once() method\r\n\r\n### binding to a model ###\r\n\r\nThe best place to setup bindings is in the controls enterDocument method. for instance:\r\n\r\n```javascript\r\nthis.click(function(e) {\r\n  this.getModel().set('star', !this.getModel().get('star'));\r\n  }, \"starButton\");\r\nthis.getModel().bind('star', function(star) {\r\n  if(star)\r\n    goog.dom.classes.add(this.getEls(\".starButton\")[0], 'star');\r\n  else\r\n    goog.dom.classes.remove(this.getEls(\".starButton\")[0], 'star');\r\n}, this);\r\n```\r\n\r\nnow clicking on the star button will change the star attribute and that will in turn change the class on the star Button. There are lots of ways to match up the bindings.\r\n\r\n## mvc.Sync ##\r\n\r\nThis is an interface that should have a custom implementation. Two simple implementations have been given called mvc.AjaxSync and mvc.LocalSync. The purpose of sync is to be the glue between the model and the dataStore.\r\n\r\nThe AjaxSync can be used and passed an object of functions or strings (with the strings acting much like the router example below) for each of the four methods create, read, update and del. These will be used for the call.\r\n\r\n## mvc.Router ##\r\n\r\nmvc.Router uses goog.History and hash tokens to hold and manage the state of the application. You can define a route with a regular expression that will fire custom events when a certain route comes on the URL. A route can be defined with a route expression which can take : followed by an attribute, a * to pass the rest of the route and [] for an optional part of the url (which will be passed to the function). For instance:\r\n\r\n```javascript\r\nroute = \"/note=:id[/edit][?*]\";\r\n```\r\nshould take a function with four attribute:\r\n```javascript\r\nfunction(id,edit,query,queryVals)\r\n```\r\n\r\nso for /note=1234567890/edit?abc=123 will give:\r\n\r\n```javascript\r\nfunction(id,edit,query,queryVals) {\r\n    console.log(id); // 1234567890\r\n    console.log(edit); // /edit\r\n    console.log(query); // ?abc=123\r\n    console.log(queryVals); // abc=123\r\n}\r\n```\r\n\r\n## mvc.Mediator ##\r\n\r\nmvc.Mediator allows message passing between components. It's most useful as a singleton so you could do this:\r\n\r\n```javascript\r\ngoog.require('mvc.Mediator');\r\n\r\n/**\r\n * @constructor\r\n * @extends {mvc.Mediator}\r\n */\r\nmyapp.Mediator=function(){};\r\ngoog.inherits(myapp.Mediator, mvc.Mediator);\r\ngoog.addSingletonGetter(myapp.Mediator);\r\n\r\n// you can then access the mediator anywhere in your app using:\r\n// mvc.Mediator.getInstance();\r\n```\r\n\r\nyou can then register your object with the mediator and the messages that you may pass. This allows other modules that are listening for a specific message to run some initiation, or dispose when you unregister. You can listen to messages using the on method and stop using the off method. You can even test to see if anyone is listening for a message using the isListened method\r\n\r\n## Testing ##\r\n\r\nTo run tests you need to run plovr. From the root:\r\n\r\n    java -jar plovr/plovr.jar serve plovr/test.js\r\n\r\nyou can then run the tests by going to:\r\n\r\n    http://localhost:9810\r\n\r\n### changelog ###\r\n\r\n### v1.0a ###\r\n\r\n- alpha release\r\n- put tests in their own folder (they'll be broken - that's why this is alpha)\r\n- redo the README\r\n- new name\r\n- tests with plovr\r\n- add in comparison ability for schema\r\n\r\n#### v0.9 ####\r\n\r\n- reworked bind for performance\r\n- schema is now an object\r\n- mvc.Control events can now be given a priority to order them\r\n- more tests\r\n- files pass closure linter in strict mode\r\n- can unbind listeners on collection model change\r\n- getBinder reworked so can use as getter and setters\r\n- control.on accepts a function as well as classname to define see if a handler should run\r\n\r\n#### v0.8 ####\r\n\r\n- lots of fixes\r\n- can reset models\r\n- passes JSHint\r\n- routes can have square brackets for optional components\r\n- change function to fire change events on mvc.Model\r\n- ajax sync now has urlifyString\r\n\r\n#### v0.7 ####\r\n\r\n- add in mvc.Mediator\r\n- schema now throws errors and handles them\r\n- fixes\r\n\r\n#### v0.6 ####\r\n\r\n- split format function up to format, alias and meta\r\n- changes fired for constructed attributes\r\n- change the models constructor arguments to an options object\r\n- store added\r\n\r\n#### v0.5 ####\r\n\r\n- add in format function on model\r\n- removed dependency on goog.dom from mvc.Model\r\n- put in convenience functions for binding elements with model attributes\r\n- put in convenience function for schema test for type of object\r\n\r\n#### v0.4 ####\r\n\r\n- added pluck in to mvc.Collection\r\n- fix sorting on models passed in at creation\r\n- added in all_tests.html\r\n- fixed mvc.Router\r\n- tests for mvc.Router\r\n\r\n#### v0.3 ####\r\n\r\n- add dispose() to mvc.Model\r\n- fix mvc.AjaxSync\r\n\r\n#### v0.2 ####\r\n\r\n- fix model.Schema\r\n- mvc.Collection now takes optional index for add()\r\n- mvc.Collection.newModel adds a new model to the collection\r\n- mvc.AjaxSync first implementation\r\n- mvc.AjaxSync first implementation\r\n\r\n#### v0.1 ####\r\n\r\n- initial documentation and versioning\r\n","tagline":"MVC framework for Closure Library and Closure Compiler","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}